<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script src="https://code.highcharts.com/maps/highmaps.js"></script>
    <script src="https://code.highcharts.com/maps/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/maps/modules/data.js"></script>
    <script src="https://code.highcharts.com/maps/modules/accessibility.js"></script>
    <script src="https://code.highcharts.com/dashboards/datagrid.js"></script>
    <script src="https://code.highcharts.com/modules/geoheatmap.js"></script>

</head>
<body>


<h1>Einf√ºhrung</h1>
<p>Lorem Ipsum....</p>

<div id="pluvial-floods-line-chart"></div>
<script>

    (async () => {


        Highcharts.chart('pluvial-floods-line-chart', {
            chart: {
                type: 'line'
            },
            title: {
                text: 'Precipitation Data Representation'
            },
            data: {
                csvURL: 'http://localhost:8000/rainfall-aggregated.csv',
                seriesMapping: [{
                    x: 4,
                    y: 9
                }]
            },
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: false
                }
            },
            yAxis: {
                title: {
                    text: 'Precipitation'
                }
            },
            xAxis: {
                title: {
                    text: 'Days'
                }
            },
        });

    })();
</script>


<script>


    (async () => {

        const data = []

        const response = await fetch('http://localhost:8000/pluvial_rainfall.csv-e')
        const text = await response.text()
        const rows = text.split('\n')

        rows.forEach(row => {
            const columns = row.split(',')

            data.push({
                lat: parseFloat(columns[1]),
                lon: parseFloat(columns[2]),
                value: parseFloat(columns[9]),
            })
        })


        const topology = await fetch(
            'https://code.highcharts.com/mapdata/custom/european-union.topo.json'
        ).then(response => response.json());

        Highcharts.mapChart('container', {
            chart: {
                map: topology
            },

            mapNavigation: {
                enabled: true,
                buttonOptions: {
                    verticalAlign: 'bottom'
                }
            },

            colorAxis: {
                min: 0,
                max: 5
            },


            series: [{
                name: 'Europe',
                borderColor: 'rgba(0, 0, 0, 0.4)',
                states: {
                    inactive: {
                        enabled: false
                    }
                },
                accessibility: {
                    exposeAsGroupOnly: true
                }
            }, {
                type: 'geoheatmap',
                name: 'Rainfall',
                opacity: 1,
                colsize: 0.2,
                rowsize: 0.2,
                borderWidth: 1,
                interpolation: {
                    enabled: true,
                    blur: 1.6
                },
                data: data,
            }
            ]
        });

    })();
</script>

</body>
</html>